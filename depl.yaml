---
deployment_id: fabio-643

regions:
  defaults: &regions
    user: ubuntu
    public_ip: yes
    public_key_id: workshop
    tags:
      owner: fabio@cockroachlabs.com
  aws:
    defaults: &aws
      <<: *regions
      cloud: aws
      image: /canonical/ubuntu/server/24.04
    us_east_1:
      defaults: &aws_us_east_1
        <<: *aws
        region: us-east-1
        vpc_id: vpc-039dd158f86366108
        security_groups:
          - sg-067d280fe7a21bc60
      a: &aws_us_east_1a
        <<: *aws_us_east_1
        zone: a
        subnet: subnet-0d933a012de53be58
      b: &aws_us_east_1b
        <<: *aws_us_east_1
        zone: b
        subnet: subnet-0a10df84fd63e9e29
      c: &aws_us_east_1c
        <<: *aws_us_east_1
        zone: c
        subnet: subnet-0838bb993e9d878eb
    us_east_2:
      defaults: &aws_us_east_2
        <<: *aws
        region: us-east-2
        vpc_id: vpc-0b3a779242fa5db6c
        security_groups:
          - sg-0083050fd3d65bd0a
      a: &aws_us_east_2a
        <<: *aws_us_east_2
        zone: a
        subnet: subnet-0b108f6429c5b6245
      b: &aws_us_east_2b
        <<: *aws_us_east_2
        zone: b
        subnet: subnet-0cb40bb62e8aba891
      c: &aws_us_east_2c
        <<: *aws_us_east_2
        zone: c
        subnet: subnet-0347bbf4b1f1e69b1
    us_west_1:
      defaults: &aws_us_west_1
        <<: *aws
        region: us-west-1
        vpc_id: vpc-0f053bbd17aaedf5b
        security_groups:
          - sg-0203a4ecd30b56dc8
      a: &aws_us_west_1a
        <<: *aws_us_west_1
        zone: a
        subnet: subnet-01bc58571a788cd1b
      b: &aws_us_west_1b
        <<: *aws_us_west_1
        zone: b
        subnet: subnet-03669c65c3e8fee3d
    us_west_2:
      defaults: &aws_us_west_2
        <<: *aws
        region: us-west-2
        vpc_id: vpc-077625823a47a856a
        security_groups:
          - sg-0d171bdc516c8cc5d
      a: &aws_us_west_2a
        <<: *aws_us_west_2
        zone: a
        subnet: subnet-0157ce39516b8d681
      b: &aws_us_west_2b
        <<: *aws_us_west_2
        zone: b
        subnet: subnet-0a8a3204a906576b6
      c: &aws_us_west_2c
        <<: *aws_us_west_2
        zone: c
        subnet: subnet-0a2e3fe107f16ecf8
    ca-central-1:
      defaults: &aws_ca_central_1
        <<: *aws
        region: ca-central-1
        vpc_id: vpc-0289741dc46c80da8
        security_groups:
          - sg-0e3631bbd91d95940
      a: &aws_ca_central_1a
        <<: *aws_ca_central_1
        zone: a
        subnet: subnet-02ed0abd3c499dca9
      b: &aws_ca_central_1b
        <<: *aws_ca_central_1
        zone: b
        subnet: subnet-057e35614fa949783
      d: &aws_ca_central_1d
        <<: *aws_ca_central_1
        zone: d
        subnet: subnet-05cd5b8d26347f3a3
    sa_east_1:
      defaults: &aws_sa_east_1
        <<: *aws
        region: sa-east-1
        vpc_id: vpc-017a70b318cde89cd
        security_groups:
          - sg-0362e11e767798232
      a: &aws_sa_east_1a
        <<: *aws_sa_east_1
        zone: a
        subnet: subnet-00539e418394f0851
      b: &aws_sa_east_1b
        <<: *aws_sa_east_1
        zone: b
        subnet: subnet-0dd3b73e9ac5fd5eb
      c: &aws_sa_east_1c
        <<: *aws_sa_east_1
        zone: c
        subnet: subnet-081d04361feba2856
    eu_central_1:
      defaults: &aws_eu_central_1
        <<: *aws
        region: eu-central-1
        vpc_id: vpc-0ad3df70aa3cb0690
        security_groups:
          - sg-0fb3bd6327688e038
      a: &aws_eu_central_1a
        <<: *aws_eu_central_1
        zone: a
        subnet: subnet-0ce2ffd974907156e
      b: &aws_eu_central_1b
        <<: *aws_eu_central_1
        zone: b
        subnet: subnet-097f1fbc3d69704e3
      c: &aws_eu_central_1c
        <<: *aws_eu_central_1
        zone: c
        subnet: subnet-0a81687e845c74df0
    eu_west_1:
      defaults: &aws_eu_west_1
        <<: *aws
        region: eu-west-1
        vpc_id: vpc-02aafafe1c5cd35a5
        security_groups:
          - sg-04e73db4742bba9e2
      a: &aws_eu_west_1a
        <<: *aws_eu_west_1
        zone: a
        subnet: subnet-0bfa107e407476a38
      b: &aws_eu_west_1b
        <<: *aws_eu_west_1
        zone: b
        subnet: subnet-0d8d3e1b0ce6084e6
      c: &aws_eu_west_1c
        <<: *aws_eu_west_1
        zone: c
        subnet: subnet-0b4f613a7823c4674
    eu_west_3:
      defaults: &aws_eu_west_3
        <<: *aws
        region: eu-west-3
        vpc_id: vpc-0d99b3749441506d0
        security_groups:
          - sg-0651d1a6791992f74
      a: &aws_eu_west_3a
        <<: *aws_eu_west_3
        zone: a
        subnet: subnet-0bbec109f92589929
      b: &aws_eu_west_3b
        <<: *aws_eu_west_3
        zone: b
        subnet: subnet-08243350d926bb5d9
      c: &aws_eu_west_3c
        <<: *aws_eu_west_3
        zone: c
        subnet: subnet-0c39d733ca2315767
    ap_northeast_1:
      defaults: &aws_ap_northeast_1
        <<: *aws
        region: ap-northeast-1
        vpc_id: vpc-04054fddd9f6f5451
        security_groups:
          - sg-02c2342a2ca1f20d6
      a: &aws_ap_northeast_1a
        <<: *aws_ap_northeast_1
        zone: a
        subnet: subnet-041e9ad692219d00c
      c: &aws_ap_northeast_1c
        <<: *aws_ap_northeast_1
        zone: c
        subnet: subnet-0b06954f08cc23602
      d: &aws_ap_northeast_1d
        <<: *aws_ap_northeast_1
        zone: d
        subnet: subnet-0bdb20569e92819c2
    ap_south_1:
      defaults: &aws_ap_south_1
        <<: *aws
        region: ap-south-1
        vpc_id: vpc-04c5e163c2864fa27
        security_groups:
          - sg-09d101960983b37c1
      a: &aws_ap_south_1a
        <<: *aws_ap_south_1
        zone: a
        subnet: subnet-05972bd4d10b54901
      b: &aws_ap_south_1b
        <<: *aws_ap_south_1
        zone: b
        subnet: subnet-07c23e2fda2e10ec0
      c: &aws_ap_south_1c
        <<: *aws_ap_south_1
        zone: c
        subnet: subnet-099185d04b7d08af0
  gcp:
    defaults: &gcp
      <<: *regions
      cloud: gcp
      image: projects/ubuntu-os-cloud/global/images/family/ubuntu-2404-lts-amd64
      project: cea-team
      security_groups:
        - cockroachdb
    us_east1:
      defaults: &gcp_us_east1
        <<: *gcp
        region: us-east1
        vpc_id: default
      d: &gcp_us_east1_d
        <<: *gcp_us_east1
        zone: d
        subnet: default
      b: &gcp_us_east1_b
        <<: *gcp_us_east1
        zone: b
        subnet: default
      c: &gcp_us_east1_c
        <<: *gcp_us_east1
        zone: c
        subnet: default
    us_east4:
      defaults: &gcp_us_east4
        <<: *gcp
        region: us-east4
        vpc_id: default
      a: &gcp_us_east4_a
        <<: *gcp_us_east4
        zone: a
        subnet: default
      b: &gcp_us_east4_b
        <<: *gcp_us_east4
        zone: b
        subnet: default
      c: &gcp_us_east4_c
        <<: *gcp_us_east4
        zone: c
        subnet: default
    us_central1:
      defaults: &gcp_us_central1
        <<: *gcp
        region: us-central1
        vpc_id: default
      a: &gcp_us_central1_a
        <<: *gcp_us_central1
        zone: a
        subnet: default
      b: &gcp_us_central1_b
        <<: *gcp_us_central1
        zone: b
        subnet: default
      c: &gcp_us_central1_c
        <<: *gcp_us_central1
        zone: c
        subnet: default
      f: &gcp_us_central1_f
        <<: *gcp_us_central1
        zone: f
        subnet: default
    us_west1:
      defaults: &gcp_us_west1
        <<: *gcp
        region: us-west1
        vpc_id: default
      a: &gcp_us_west1_a
        <<: *gcp_us_west1
        zone: a
        subnet: default
      b: &gcp_us_west1_b
        <<: *gcp_us_west1
        zone: b
        subnet: default
      c: &gcp_us_west1_c
        <<: *gcp_us_west1
        zone: c
        subnet: default
    us_west4:
      defaults: &gcp_us_west4
        <<: *gcp
        region: us-west4
        vpc_id: default
      a: &gcp_us_west4_a
        <<: *gcp_us_west4
        zone: a
        subnet: default
      b: &gcp_us_west4_b
        <<: *gcp_us_west4
        zone: b
        subnet: default
      c: &gcp_us_west4_c
        <<: *gcp_us_west4
        zone: c
        subnet: default
    southamerica_west1:
      defaults: &gcp_southamerica_west1
        <<: *gcp
        region: southamerica-west1
        vpc_id: default
      a: &gcp_southamerica_west1_a
        <<: *gcp_southamerica_west1
        zone: a
        subnet: default
      b: &gcp_southamerica_west1_b
        <<: *gcp_southamerica_west1
        zone: b
        subnet: default
      c: &gcp_southamerica_west1_c
        <<: *gcp_southamerica_west1
        zone: c
        subnet: default
    europe_north1:
      defaults: &gcp_europe_north1
        <<: *gcp
        region: europe-north1
        vpc_id: default
      a: &gcp_europe_north1_a
        <<: *gcp_europe_north1
        zone: a
        subnet: default
      b: &gcp_europe_north1_b
        <<: *gcp_europe_north1
        zone: b
        subnet: default
      c: &gcp_europe_north1_c
        <<: *gcp_europe_north1
        zone: c
        subnet: default
    europe_west2:
      defaults: &gcp_europe_west2
        <<: *gcp
        region: europe-west2
        vpc_id: default
      a: &gcp_europe_west2_a
        <<: *gcp_europe_west2
        zone: a
        subnet: default
      b: &gcp_europe_west2_b
        <<: *gcp_europe_west2
        zone: b
        subnet: default
      c: &gcp_europe_west2_c
        <<: *gcp_europe_west2
        zone: c
        subnet: default
    europe_west1:
      defaults: &gcp_europe_west1
        <<: *gcp
        region: europe-west1
        vpc_id: default
      a: &gcp_europe_west1_a
        <<: *gcp_europe_west1
        zone: a
        subnet: default
      b: &gcp_europe_west1_b
        <<: *gcp_europe_west1
        zone: b
        subnet: default
      c: &gcp_europe_west1_c
        <<: *gcp_europe_west1
        zone: c
        subnet: default
    australia_southeast1:
      defaults: &gcp_australia_southeast1
        <<: *gcp
        region: australia-southeast1
        vpc_id: default
      a: &gcp_australia_southeast1_a
        <<: *gcp_australia_southeast1
        zone: a
        subnet: default
      b: &gcp_australia_southeast1_b
        <<: *gcp_australia_southeast1
        zone: b
        subnet: default
      c: &gcp_australia_southeast1_c
        <<: *gcp_australia_southeast1
        zone: c
        subnet: default
    asia_southeast2:
      defaults: &gcp_asia_southeast2
        <<: *gcp
        region: asia-southeast2
        vpc_id: default
      a: &gcp_asia_southeast2_a
        <<: *gcp_asia_southeast2
        zone: a
        subnet: default
      b: &gcp_asia_southeast2_b
        <<: *gcp_asia_southeast2
        zone: b
        subnet: default
      c: &gcp_asia_southeast2_c
        <<: *gcp_asia_southeast2
        zone: c
        subnet: default
    asia_northeast2:
      defaults: &gcp_asia_northeast2
        <<: *gcp
        region: asia-northeast2
        vpc_id: default
      a: &gcp_asia_northeast2_a
        <<: *gcp_asia_northeast2
        zone: a
        subnet: default
      b: &gcp_asia_northeast2_b
        <<: *gcp_asia_northeast2
        zone: b
        subnet: default
      c: &gcp_asia_northeast2_c
        <<: *gcp_asia_northeast2
        zone: c
        subnet: default
    me_west1:
      defaults: &gcp_me_west1
        <<: *gcp
        region: me-west1
        vpc_id: default
      a: &gcp_me_west1_a
        <<: *gcp_me_west1
        zone: a
        subnet: default
      b: &gcp_me_west1_b
        <<: *gcp_me_west1
        zone: b
        subnet: default
      c: &gcp_me_west1_c
        <<: *gcp_me_west1
        zone: c
        subnet: default
  azure:
    defaults: &azure
      <<: *regions
      cloud: azure
      subnet: default
      security_groups: []
      public_key_id: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCq1rsiS+AtRRko5mamLoFHkUBGo6CSvR5TEmG8/7/F33GOHSFHh2S8AfaUkQ8a1vM+7nac8Dk2MGGZTDdytpBCrrIL+E5vy/yWNUuy+mWgcTz2fi1eds6z4eCUeMp0QF/iOG7CsfXUAeTKrUkmiiXUdQj7o9jgJLyqgGKRZc0Gv/VMr/+oKrcDL4i05dy1CS7UG36ExK0YOKcc0KjAO4qJg0EDHkI0fD7ZMFdxFk/y39KKGrRi1MC9I5yiJXOBOSTtltkUodprQHULUlehFN8lP4d+XMwwnPYD9ujhx4IYt8cJ5CeSrCDEIxlaebJoOYnDQMhZCtkeGavYFSWsQgHR workshop
      image: Canonical:0001-com-ubuntu-server-focal:24_04-lts:latest
    eastus:
      defaults: &azure_eastus
        <<: *azure
        region: eastus
        vpc_id: eastus-vnet
      default: &azure_eastus_default
        <<: *azure_eastus
        zone: default
    eastus2:
      defaults: &azure_eastus2
        <<: *azure
        region: eastus2
        vpc_id: eastus2-vnet
      default: &azure_eastus2_default
        <<: *azure_eastus2
        zone: default
    centralus:
      defaults: &azure_centralus
        <<: *azure
        region: centralus
        vpc_id: centralus-vnet
      default: &azure_centralus_default
        <<: *azure_centralus
        zone: default
    northcentralus:
      defaults: &azure_northcentralus
        <<: *azure
        region: northcentralus
        vpc_id: northcentralus-vnet
      default: &azure_northcentralus_default
        <<: *azure_northcentralus
        zone: default
    westcentralus:
      defaults: &azure_westcentralus
        <<: *azure
        region: westcentralus
        vpc_id: westcentralus-vnet
      default: &azure_westcentralus_default
        <<: *azure_westcentralus
        zone: default
    southcentralus:
      defaults: &azure_southcentralus
        <<: *azure
        region: southcentralus
        vpc_id: southcentralus-vnet
      default: &azure_southcentralus_default
        <<: *azure_southcentralus
        zone: default
    westus:
      defaults: &azure_westus
        <<: *azure
        region: westus
        vpc_id: westus-vnet
      default: &azure_westus_default
        <<: *azure_westus
        zone: default
    westus2:
      defaults: &azure_westus2
        <<: *azure
        region: westus2
        vpc_id: westus2-vnet
      default: &azure_westus2_default
        <<: *azure_westus2
        zone: default
    westus3:
      defaults: &azure_westus3
        <<: *azure
        region: westus3
        vpc_id: westus3-vnet
      default: &azure_westus3_default
        <<: *azure_westus3
        zone: default
    southafricanorth:
      defaults: &azure_southafricanorth
        <<: *azure
        region: southafricanorth
        vpc_id: southafricanorth-vnet
      default: &azure_southafricanorth_default
        <<: *azure_southafricanorth
        zone: default
    koreacentral:
      defaults: &azure_koreacentral
        <<: *azure
        region: koreacentral
        vpc_id: koreacentral-vnet
      default: &azure_koreacentral_default
        <<: *azure_koreacentral
        zone: default
    francecentral:
      defaults: &azure_francecentral
        <<: *azure
        region: francecentral
        vpc_id: francecentral-vnet
      default: &azure_francecentral_default
        <<: *azure_francecentral
        zone: default
    westeurope:
      defaults: &azure_westeurope
        <<: *azure
        region: westeurope
        vpc_id: westeurope-vnet
      default: &azure_westeurope_default
        <<: *azure_westeurope
        zone: default

deployment:
  - cluster_name: "{{ deployment_id }}"
    copies: 0
    inventory_groups:
      # - app
      - haproxy
    exact_count: 1
    instance:
      cpu: 2
    volumes:
      os:
        size: 30
        type: standard_ssd
      data: []
    tags:
      Name: "{{ deployment_id }}-app"
    groups:
      - <<: *aws_sa_east_1a


  - cluster_name: "{{ deployment_id }}"
    group_name: cockroachdb
    copies: 0
    inventory_groups:
      - cockroachdb
    exact_count: 3
    role: roachprod-testing
    # instance_type: r5.4xlarge
    #image: ami-0120d88db7a0c4125
    instance:
      cpu: 2
      # mem: 16
    volumes:
      os:
        size: 30
        type: standard_ssd
      data: 
         - size: 200
           type: standard_ssd
           iops: 1000
           throughput: 180
           delete_on_termination: true
    tags:
      Name: "{{ deployment_id }}-cockroach"
    extra_vars: {}
    groups:
      - <<: *aws_sa_east_1a